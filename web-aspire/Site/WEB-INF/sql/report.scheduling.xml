<?xml version="1.0"?>

<xaf>
	<sql-statements package="report.scheduling">
		<statement name="id">
			App::Statements::Report::Scheduling
		</statement>

		<statement name="sel_DetailAppointmentStatus">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	e.event_status = :1
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_DetailDiscardAppointment">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Discard_Type WHERE id = e.discard_type) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			, discard_remarks 
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	e.event_status = :1
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_appointments_byStatus">
			
			select caption as appointments, count(caption) as count, event_status
			from Appt_Status, Event, Event_Attribute
			where value_type = 333
			and Event.event_id = Event_Attribute.parent_id
			and (:6 is NULL or Event_Attribute.value_textb = :6)
			and (:1 is NULL or Event.facility_id = :1)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = Event.facility_id
			)
			and Event.start_time &gt;= to_date(:2, 'MM/DD/YYYY') + :5
			and Event.start_time &lt; to_date(:3, 'MM/DD/YYYY') + 1 + :5
			and Appt_Status.id = Event.event_status
			group by caption, event_status
			
		</statement>

		<statement name="sel_dateEntered">
			
			SELECT to_char(e.scheduled_stamp -:5, 'MM/DD/YYYY'), count(*)
			FROM 	Event e, Event_Attribute ea
			WHERE	(:1 is NULL or facility_id = :1)
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			AND ea.value_type = 333
			AND e.scheduled_stamp &gt;= TO_DATE(:2, 'MM/DD/YYYY') + :5
			AND e.scheduled_stamp &lt; TO_DATE(:3, 'MM/DD/YYYY') + 1 + :5
			AND e.event_id = ea.parent_id
			GROUP BY to_char(e.scheduled_stamp -:5, 'MM/DD/YYYY')
			ORDER BY 1 desc
			
		</statement>

		<statement name="sel_detailDateEntered">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	
			e.scheduled_stamp &gt;= TO_DATE(:1, 'MM/DD/YYYY') + :6
			and e.scheduled_stamp &lt; TO_DATE(:1, 'MM/DD/YYYY') + 1 + :6
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.scheduled_stamp &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.scheduled_stamp &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailMissingEncounter">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	
			e.checkin_stamp &gt;= TO_DATE(:1, 'MM/DD/YYYY') + :6
			and e.checkin_stamp &lt; TO_DATE(:1, 'MM/DD/YYYY') + 1 + :6
			and e.checkout_stamp is NULL
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND e.event_status &lt; 3
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailPatientsCPT">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			,	transaction t,
			invoice i,
			invoice_item ii
			WHERE	ii.parent_id = i.invoice_id
			AND ii.code = :1
			AND ((ii.data_text_b is NOT NULL AND ii.data_text_b != 'void')
			OR ii.data_text_b is NULL)
			AND ii.item_type != 7
			AND i.main_transaction = t.trans_id
			AND i.invoice_status != 16
			AND i.parent_invoice_id is NULL
			AND e.event_id = t.parent_event_id
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND e.event_status &lt; 3
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailPatientsProduct">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			,invoice i,
			invoice_billing ib,
			insurance i,
			claim_type ct,
			transaction t
			WHERE		ct.caption = :1
			AND	e.event_id = t.parent_event_id
			AND	i.main_transaction = t.trans_id
			AND	ib.bill_id = i.billing_id
			AND	ib.bill_ins_id = i.ins_internal_id
			AND	ct.id = i.ins_type
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND e.event_status &lt; 3
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailPatientsProductSelfPay">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			,invoice i,
			invoice_billing ib,
			claim_type ct,
			transaction t
			WHERE		ct.caption = :1
			AND	e.event_id = t.parent_event_id
			AND	i.main_transaction = t.trans_id
			AND	ib.bill_id = i.billing_id
			AND	ib.bill_ins_id is NULL
			AND	ct.id = 0
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND e.event_status &lt; 3
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailPatientsSeenByPatientType">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	ea.value_int = :1 and event_status = 2 
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_detailPatientsSeenByPhysician">
			
			SELECT
			(SELECT InitCap(simple_name)
			FROM 	person
			WHERE 	person_id = ea.value_text
			) as patient_name,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Account Number'
			) as account_number,
			(SELECT	value_text
			FROM	Person_Attribute pa
			WHERE	pa.parent_id = ea.value_text
			AND	pa.item_name = 'Patient/Chart Number'
			) as chart_number,
			(SELECT initcap(simple_name)
			FROM person
			WHERE person_id = ea.value_textb
			) as physician_name,
			(SELECT org_id
			FROM org
			WHERE org_internal_id = e.facility_id
			) as org_name,
			(SELECT caption FROM Appt_Status WHERE id = e.event_status) as appt_status,
			TO_CHAR(e.start_time - :6, 'MM/DD/YYYY HH12:MI AM') as start_time,
			initcap(e.subject) as reason_visit,
			e.scheduled_by_id as scheduled_by,
			e.checkin_by_id as checkin_by,
			e.checkout_by_id as checkout_by,
			ea.value_text as patient_id,
			ea.value_textb as physician_id,
			to_char(e.scheduled_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as scheduled_stamp,
			to_char(e.checkin_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkin_stamp,
			to_char(e.checkout_stamp - :6, 'MM/DD/YYYY HH12:MI AM') as checkout_stamp,
			e.event_id,
			aat.caption
			FROM	Appt_Attendee_Type aat, Event e, Event_Attribute ea
			WHERE	 event_status = 2 AND ea.value_textB = :1
			AND	(:2 is NULL or e.facility_id = :2)
			AND (:7 is NULL or ea.value_textb = :7)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :5
			AND org_internal_id = e.facility_id
			)
			AND e.event_id = ea.parent_id
			AND e.start_time &gt;= TO_DATE(:3, 'MM/DD/YYYY') + :6
			AND e.start_time &lt; TO_DATE(:4, 'MM/DD/YYYY') + 1 + :6
			AND aat.id = ea.value_int
			ORDER BY 5, 7

		</statement>

		<statement name="sel_missingEncounter">
			
			SELECT to_char(e.CHECKIN_STAMP - :5, 'MM/DD/YYYY'), count (*)
			FROM 	Event e, Event_Attribute ea
			WHERE	(:1 is NULL or facility_id = :1)
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			AND ea.value_type = 333
			AND e.start_time &gt;= TO_DATE(:2, 'MM/DD/YYYY') + :5
			AND e.start_time &lt; TO_DATE(:3, 'MM/DD/YYYY') + 1 + :5
			AND e.event_id = ea.parent_id
			AND e.event_status &lt; 3
			AND e.checkin_stamp is NOT NULL
			AND e.checkout_stamp is NULL
			GROUP BY to_char(e.CHECKIN_STAMP - :5, 'MM/DD/YYYY')
			ORDER BY 1 desc
			
		</statement>

		<statement name="sel_patientsCPT">
			
			SELECT	ii.code,count(distinct(e.event_id)) as count
			FROM	Event e,
			Event_Attribute ea,
			transaction t,
			invoice i,
			invoice_item ii
			WHERE	ea.value_type = 333
			AND ((ii.data_text_b is NOT NULL AND ii.data_text_b != 'void')
			OR ii.data_text_b is NULL)
			AND ii.item_type != 7
			AND (:1 is NULL or e.facility_id = :1)
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 	'x'
			FROM 	org
			WHERE 	owner_org_id = :4
			AND 	org_internal_id = e.facility_id
			)
			AND e.start_time &gt;= TO_DATE(:2, 'MM/DD/YYYY') + :5
			AND e.start_time &lt; TO_DATE(:3, 'MM/DD/YYYY') + 1 + :5
			AND e.event_id = ea.parent_id
			AND e.event_id = t.parent_event_id
			AND e.event_status &lt; 3
			AND i.main_transaction = t.trans_id
			AND i.invoice_status != 16
			AND i.parent_invoice_id is NULL
			AND ii.parent_id = i.invoice_id
			AND ii.code is not NULL
			GROUP BY ii.code
			ORDER BY 1
			
		</statement>

		<statement name="sel_patientsProduct">
			
			SELECT	ct.caption, count(distinct e.event_id) as count
			FROM claim_type ct,
			insurance ins,
			invoice_billing ib,
			invoice i,
			transaction t,
			Event_Attribute ea,
			Event e
			WHERE e.start_time &gt;= TO_DATE(:2, 'MM/DD/YYYY') + :5
			AND e.start_time &lt; TO_DATE(:3, 'MM/DD/YYYY') + 1 + :5
			AND e.event_status &lt; 3
			AND (:1 is NULL or e.facility_id = :1)
			AND ea.parent_id = e.event_id
			AND ea.value_type = 333
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			AND t.parent_event_id = e.event_id
			AND i.main_transaction = t.trans_id
			AND i.parent_invoice_id is NULL
			AND i.invoice_status != 16
			AND ib.bill_id = i.billing_id
			AND ins.ins_internal_id = ib.bill_ins_id
			AND ct.id = ins.ins_type
			GROUP BY ct.caption
			UNION
			SELECT	ct.caption, count(distinct e.event_id) as count
			FROM claim_type ct,
			insurance ins,
			invoice_billing ib,
			invoice i,
			transaction t,
			Event_Attribute ea,
			Event e
			WHERE e.start_time &gt;= TO_DATE(:2, 'MM/DD/YYYY') + :5
			AND	e.start_time &lt; TO_DATE(:3, 'MM/DD/YYYY') + 1 + :5
			AND e.event_status &lt; 3
			AND (:1 is NULL or e.facility_id = :1)
			AND	ea.parent_id = e.event_id
			AND ea.value_type = 333
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			AND t.parent_event_id = e.event_id
			AND i.main_transaction = t.trans_id
			AND i.parent_invoice_id is NULL
			AND i.invoice_status != 16
			AND ib.bill_id = i.billing_id
			AND ib.bill_ins_id is NULL
			AND ct.id = 0
			GROUP BY ct.caption
			
		</statement>

		<statement name="sel_patientsSeen">
			
			select value_textB as physician, count(value_textB) as count
			from Event e, Event_Attribute ea
			where ea.value_type = 333
			AND (:1 is NULL or e.facility_id = :1)
			AND (:6 is NULL or ea.value_textb = :6)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			and e.event_id = ea.parent_id
			and e.start_time between to_date(:2 || ' 12:00 AM', 'MM/DD/YYYY HH12:MI AM') + :5
			and to_date(:3 || ' 11:59 PM', 'MM/DD/YYYY HH12:MI AM') + :5
			and e.event_status = 2
			group by ea.value_textB
			
		</statement>

		<statement name="sel_patientsSeen_byPatientType">
			
			select caption as patient_type, count(caption) as count, Appt_Attendee_Type.id
			from Appt_Attendee_Type, Event e, Event_Attribute ea
			where ea.value_type = 333
			and e.event_id = ea.parent_id
			and (:6 is NULL or ea.value_textb = :6)
			and (:1 is NULL or e.facility_id = :1)
			AND EXISTS
			(
			SELECT 'x'
			FROM org
			WHERE owner_org_id = :4
			AND org_internal_id = e.facility_id
			)
			and e.start_time between to_date(:2 || ' 12:00 AM', 'MM/DD/YYYY HH12:MI AM') + :5
			and to_date(:3 || ' 11:59 PM', 'MM/DD/YYYY HH12:MI AM') + :5
			and e.event_status = 2
			and Appt_Attendee_Type.id = ea.value_int
			group by caption, Appt_Attendee_Type.id
			
		</statement>

	</sql-statements>
</xaf>