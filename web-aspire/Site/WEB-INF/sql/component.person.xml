<?xml version="1.0"?>

<xaf>
	<sql-statements package="component.person">
		<statement name="id">
			App::Statements::Component::Person
		</statement>

		<statement name="person.account-notes">
			
			SELECT * FROM (
			select to_char(trans_begin_stamp -?, 'MM/DD/YYYY'),
			detail, trans_id, trans_type, provider_id
			from transaction
			where trans_owner_id = ?
			and trans_status = 2
			and trans_type = 9500
			order by trans_id desc
			)
			WHERE ROWNUM &lt; 11
			
			<report>
				<column heading="Account Notes"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#3#/#2#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#&{?}# - by #4#<br/> <b>#1#</b>'
						head => 'Account Notes'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-account-notes?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.accountPanel">
			
			SELECT
			i.invoice_id,
			i.client_id,
			i.owner_id,
			i.submitter_id,
			i.invoice_date,
			i.total_cost,
			i.balance,
			ib.bill_to_id,
			(
			SELECT 	b.org_id
			FROM org b
			WHERE b.org_internal_id = ib.bill_to_id
			AND ib.bill_party_type not in(0,1)
			) AS org_id,
			ib.bill_party_type
			FROM invoice i, invoice_billing ib
			WHERE i.client_id = ?
			AND ib.invoice_id = i.invoice_id
			AND ib.bill_sequence = 1
			AND ib.invoice_item_id is NULL
			AND i.balance &gt; 0
			ORDER BY i.invoice_date
			
			<params>
				<param value="request:client_id"/>
			</params>
			<report>
				<column index="9" heading="Invoice"/>
			</report>
			<!--
				bullets => '/invoice/#0#/summary?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '9'
						dataFmt => {
							0 => '<b>Invoice: </b>#0#, Bill To: #7#<BR><b>Total Amount:</b> $#5#, <b>Balance Remaining:</b> $#6#'
							1 => '<b>Invoice: </b>#0#, Bill To: #7#<BR><b>Total Amount:</b> $#5#, <b>Balance Remaining:</b> $#6#'
							2 => '<b>Invoice: </b>#0#, Bill To: #8#<BR><b>Total Amount:</b> $#5#, <b>Balance Remaining:</b> $#6#'
							3 => '<b>Invoice: </b>#0#, Bill To: #8#<BR><b>Total Amount:</b> $#5#, <b>Balance Remaining:</b> $#6#'

						}
						head => 'Invoice'

					}

				}

			-->
		</statement>

		<statement name="person.activeMedications">
			
			SELECT
			permed_id,
			med_name,
			dose,
			dose_units,
			TO_CHAR(start_date, 'IYYYMMDD') as start_date,
			frequency,
			num_refills,
			approved_by
			FROM
			Person_Medication
			WHERE
			parent_id = ? AND
			(end_date IS NULL OR end_date &gt;= TRUNC(sysdate))
			ORDER BY
			start_date DESC,
			med_name
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="1" heading="Medication"/>
				<column index="4" type="date" heading="Date"/>
				<column heading="Dosage"/>
				<column index="5" heading="Freq"/>
				<column heading="Refills"/>
				<column index="7" heading="Approved By"/>
				<column index="8" heading="Print"/>
			</report>
			<!--
				bullets => {
					0 => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-medication/#0#?home=#homeArl#'
					1 => {
						imgSrc => '/resources/widgets/mail/prescription.gif'
						title => 'Refill Request'
						urlFmt => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-refill-medication/#0#?home=#homeArl#'

					}

				}
				columnDefn => {
					0 => {
						colIdx => '1'
						head => 'Medication'

					}
					1 => {
						colIdx => '4'
						dformat => 'date'
						head => 'Date'

					}
					2 => {
						dataFmt => '#2##3#'
						head => 'Dosage'

					}
					3 => {
						colIdx => '5'
						head => 'Freq'

					}
					4 => {
						dataFmt => '#6# Refills'
						head => 'Refills'

					}
					5 => {
						colIdx => '7'
						head => 'Approved By'

					}
					6 => {
						colIdx => '8'
						dataFmt => '<a href=javascript:doActionPopup('/popup/prescription_pdf?permed_id=#0#');>Print Prescription</a>'
						head => 'Print'

					}

				}

			-->
		</statement>

		<statement name="person.activeMedicationsOld">
			
			SELECT
			tr.trans_type,
			tr.trans_id,
			tr.caption,
			decode(to_char(tr.trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(tr.trans_begin_stamp, 'Mon DD'), to_char(tr.trans_begin_stamp, 'MM/DD/YY')),
			tt.caption,
			tr.provider_id,
			tr.data_text_a
			FROM
			transaction tr,
			transaction_type tt
			WHERE
			tr.trans_type BETWEEN 7000 AND 7999
			AND tr.trans_type = tt.id
			AND tr.trans_owner_type = 0
			AND tr.trans_owner_id = ?
			AND tr.trans_status = 2
			ORDER BY tr.trans_begin_stamp DESC
			
			<params>
				<param value="request:trans_owner_id"/>
			</params>
			<report>
				<column index="3" heading="Date"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '3'
						dataFmt => '#2# (#4#)<BR>by <A HREF ="/person/#5#/profile">#5#</A> (#3#)'
						head => 'Date'

					}

				}

			-->
		</statement>

		<statement name="person.activeProblems">
			
			select 0 as GROUP_SORT, decode(to_char(sysdate, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(sysdate, 'Mon DD'), to_char(sysdate, 'MM/DD/YY')) as curr_onset_date, 'Claims in progress: ' || count(invoice_id), '' as provider_id, 11 as trans_type, 111 as trans_id, '' as code
			from invoice where invoice_type = 0 and invoice_status &lt; 3 and client_id = ?
			UNION ALL
			select 1 as GROUP_SORT, decode(to_char(sysdate, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(sysdate, 'Mon DD'), to_char(sysdate, 'MM/DD/YY')) as curr_onset_date, '-', '-', -1 as trans_type, -1 as trans_id, '' as code
			from dual
			UNION ALL
			select 	2 as GROUP_SORT, decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')) as curr_onset_date, data_text_a, provider_id, trans_type, trans_id, '' as code
			from 	transaction
			where 	trans_type = 3100 and trans_owner_id = ?
			and 	trans_status = 2
			UNION ALL
			select	2 as GROUP_SORT, decode(to_char(t.curr_onset_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(t.curr_onset_date, 'Mon DD'), to_char(t.curr_onset_date, 'MM/DD/YY')) as curr_onset_date, ref.descr, provider_id, trans_type, trans_id, '(ICD ' || t.code || ')' as code
			from 	transaction t, ref_icd ref
			where 	trans_type = 3020
			and 	trans_owner_type = 0 and trans_owner_id = ?
			and 	t.code = ref.icd (+)
			and 	trans_status = 2
			UNION ALL
			select	2 as GROUP_SORT, decode(to_char(curr_onset_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(curr_onset_date, 'Mon DD'), to_char(curr_onset_date, 'MM/DD/YY')), data_text_a, provider_id, trans_type, trans_id, '' as code
			from 	transaction
			where 	trans_type between 3000 and 3010
			and 	trans_owner_id = ?
			and 	trans_status = 2
			order by GROUP_SORT, curr_onset_date DESC
			
			<params>
				<param value="request:client_id"/>
				<param value="request:trans_owner_id"/>
				<param value="request:trans_owner_id"/>
				<param value="request:trans_owner_id"/>
			</params>
			<report>
				<column heading="Active Problems"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-remove-trans-#4#/#5#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#2# <A HREF = "/search/icd">#6#</A><BR>by <A HREF = "/person/#3#/profile">#3#</A> (#1#)'
						head => 'Active Problems'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}
				separateDataColIdx => '2'

			-->
		</statement>

		<statement name="person.additionalData">
			
			select item_name, value_text, value_type, item_id
			from 	person_attribute
			where	parent_id = ?
			and 	value_type = 820
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Additional Data"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#2#/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:0}: '
						head => 'Additional Data'

					}
					1 => {
						dataFmt => '#1#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-person-additional?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.addresses">
			
			SELECT
			address_name,
			complete_addr_html,
			item_id
			FROM Person_address
			WHERE parent_id = ?
			ORDER BY address_name

			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Address"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<IMG SRC="/resources/icons/address.gif">'

					}
					1 => {
						dataFmt => '<b>#0#</b><BR>#1#'
						head => 'Address'

					}

				}

			-->
		</statement>

		<statement name="person.advancedDirectives">
			
			select 	value_type, item_id, decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY')), item_name
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type in (420, 421)
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Advance Directives"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-remove-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:3} (#2#)'
						head => 'Advance Directives'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.affiliations">
			
			select 	value_type, item_id, item_name, value_text, decode(to_char(value_dateend, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_dateend, 'Mon DD'), to_char(value_dateend, 'MM/DD/YY'))
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 530
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Affiliation"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}, #3# (#4#) <br>'
						head => 'Affiliation'
						options => '1'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-affiliation?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.alerts">
			
			SELECT
			t.caption,
			detail,
			trans_type,
			trans_id,
			trans_subtype,
			decode(to_char(trans_end_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_end_stamp, 'Mon DD'), to_char(trans_end_stamp, 'MM/DD/YY')) as value_dateend,
			(
			SELECT
			trans_type
			FROM person_attribute p
			WHERE p.item_id = t.data_text_b
			AND t.trans_type = 8040
			) AS type
			FROM alert_priority a, transaction t
			WHERE trans_type between 8000 and 8999
			AND trans_owner_type = 0
			AND trans_owner_id = ?
			AND trans_status = 2
			AND a.caption = t.trans_subtype
			AND NOT EXISTS (
			SELECT tt.trans_end_stamp
			FROM transaction tt, person_attribute pa
			WHERE tt.trans_id = t.trans_id
			AND tt.trans_end_stamp &gt; sysdate + 90
			AND tt.data_text_b = pa.item_id
			AND tt.trans_type = 8040
			)
			ORDER BY a.id desc, trans_begin_stamp desc
			
			<report>
				<column index="6"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#2#/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '6'
						dataFmt => {
							 => '<b>#4#</b>: #0#<br/><I>#1#</I>'
							8040 => '<b>#4#</b>: #0#<br/><I>#1# (Due Date: #5#)</I>'

						}

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-alert-person?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.allMedications">
			
			SELECT
			permed_id,
			med_name,
			dose,
			dose_units,
			TO_CHAR(start_date, 'IYYYMMDD') as start_date,
			frequency,
			num_refills,
			approved_by,
			TO_CHAR(end_date, 'IYYYMMDD') as end_date
			FROM
			Person_Medication
			WHERE
			parent_id = ?
			ORDER BY
			start_date DESC,
			med_name
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="1" heading="Medication"/>
				<column index="4" type="date" heading="Start Date"/>
				<column index="8" type="date" heading="End Date"/>
				<column heading="Dosage"/>
				<column index="5" heading="Freq"/>
				<column heading="Refills"/>
				<column index="7" heading="Approved By"/>
			</report>
			<!--
				bullets => {
					0 => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-medication/#0#?home=#homeArl#'
					1 => {
						imgSrc => '/resources/widgets/mail/prescription.gif'
						title => 'Refill Request'
						urlFmt => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-refill-medication/#0#?home=#homeArl#'

					}

				}
				columnDefn => {
					0 => {
						colIdx => '1'
						head => 'Medication'

					}
					1 => {
						colIdx => '4'
						dformat => 'date'
						head => 'Start Date'

					}
					2 => {
						colIdx => '8'
						dformat => 'date'
						head => 'End Date'

					}
					3 => {
						dataFmt => '#2##3#'
						head => 'Dosage'

					}
					4 => {
						colIdx => '5'
						head => 'Freq'

					}
					5 => {
						dataFmt => '#6# Refills'
						head => 'Refills'

					}
					6 => {
						colIdx => '7'
						head => 'Approved By'

					}

				}

			-->
		</statement>

		<statement name="person.allergies">
			
			select 	value_type, item_id,item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type in (410, 411, 412)
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Allergies"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}: <I>#3#</I>'
						head => 'Allergies'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.appointmentCount">
			
			SELECT
			count(e.discard_type),
			DECODE(d.caption, 'Patient Reschedule','Reschedule', d.caption)
			FROM event e, event_attribute ea, Appt_Discard_Type d, person p
			WHERE Ea.value_text = p.person_id
			AND p.person_id = ?
			AND ea.parent_id = e.event_id
			AND d.id = e.discard_type
			GROUP BY d.caption
			
			<params>
				<param value="request:person_id"/>
			</params>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '#1#s : #0#'

					}

				}

			-->
		</statement>

		<statement name="person.associatedResources">
			
			select 	value_type, item_id, item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 250
			and item_name = 'Physician'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Record"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-assoc-nurse-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}:'
						head => 'Record'

					}
					1 => {
						dataFmt => '#3#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-resource-nurse?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.associatedSessionPhysicians">
			
			select value_text as resource_id
			from Person_Attribute
			where parent_id = ?
			and value_type = 250
			and item_name = 'WorkList'
			and parent_org_id = ?
			order by 1
			
			<report>
				<column heading="Record"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '#0#'
						head => 'Record'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-resource-session-physicians?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.attendance">
			
			select 	value_type, item_id, item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 800
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Reason"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}: #3#'
						head => 'Reason'
						options => '1'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-attendance?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.authorization">
			
			select value_type, item_id, item_name, value_text, decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY'))
			from 	person_attribute
			where	parent_id = ?
			and 	value_type in (
			370,
			371,
			372
			)
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="2" heading="Type"/>
				<column index="3" heading="Text"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '2'
						dataFmt => '&{fmt_stripLeadingPath:2} (#4#):'
						head => 'Type'

					}
					1 => {
						colIdx => '3'
						dataFmt => '#3#'
						head => 'Text'

					}

				}
				frame => {

				}

			-->
		</statement>

		<statement name="person.benefits">
			
			select 	value_type, item_id, item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type in (700, 710, 720)
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Benefits"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}:'
						head => 'Benefits'
						options => '1'

					}
					1 => {
						dataFmt => '#3#'
						options => '1'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.billinginfo">
			
			select value_type, item_id, value_text, decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY')),
			decode(value_int, 0,'Per-Se', 2,'THINet', 'Other'),
			decode(value_intb, '1','Active', 'Inactive')
			from	person_attribute
			where	parent_id = ?
			and	value_type = 960
			order by value_int
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="0"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#/0?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '0'
						dataFmt => '<b>#5#</b> #4# ID: <b>#2#</b> (Effective: #3#)'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.bloodType">
			
			SELECT
			value_type,
			item_id,
			parent_id,
			item_name,
			DECODE(value_text, '', 'Unknown', (
			SELECT b.caption
			FROM blood_type b
			WHERE b.id = p.value_text
			)
			) AS caption
			FROM Person_Attribute p
			WHERE 	parent_id = ?
			AND item_name = 'BloodType'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-blood-type/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => 'Blood Type: #4#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-blood-type?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.bookmarks">
			
			select value_text, value_textb, parent_id, item_id
			from person_attribute
			where parent_id = ?
			and item_name = 'Bookmarks'
			
			<report>
				<column heading="Bookmarks"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-book-marks/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#1#: <A HREF="#0#">#0#</A>'
						head => 'Bookmarks'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-book-marks?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.careProviders">
			
			select
			p.value_type,
			p.item_id,
			p.item_name,
			p.value_text,
			p.value_textb,
			p.parent_id,
			decode(p.value_int,1,', Primary Physician', ''),
			pc.category
			from 	person_org_category pc, person_attribute p
			where p.parent_id = upper(?)
			and p.value_type = 210
			and pc.person_id = p.value_text
			and pc.org_internal_id = ?
			and pc.category in ('Physician', 'Referring-Doctor')
			
			<report>
				<column index="7" heading="CareProvider"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '7'
						dataFmt => {
							Physician => '<A HREF = '/person/#3#/profile' title='View #3# Profile'>#3#</A> (#2##6#)
						<A HREF ='/person/#5#/dlg-add-appointment/#5#/#3#?_dialogreturnurl=#homeArl#' title='Schedule Appointment with #3#'>Sched Appointment</A>
					'
							Referring-Doctor => '<A HREF = '/person/#3#/profile'>#3#</A> (#2#, #6#)'

						}
						head => 'CareProvider'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-assoc-provider?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.certification">
			
			select 	value_type, item_id, item_name, value_text, decode(to_char(value_dateend, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_dateend, 'Mon DD'), to_char(value_dateend, 'MM/DD/YY')),
			(select (decode(a.value_int,5,'Unknown',1,'Primary',2,'Secondary',3,'Tertiary',4,'Quaternary'))
			from person_attribute a where a.value_type in (540) and a.item_id = b.item_id)value_int,
			name_sort,
			decode(sign(value_dateend - sysdate), -1, 'Inactive', 'Active'),
			decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY'))
			from 	person_attribute b
			where 	parent_id = ?
			and 	value_type in (500, 510, 520, 540, 550, 560)
			and item_name not in('Nurse/Title', 'RN', 'Driver/License', 'Employee')
			order by value_int
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="0"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '0'
						dataFmt => {
							500 => '<b>#7#</b> #2# (#8# - #4# #5#): #3#, #6#'
							510 => '<b>#7#</b> #2# (#8# - #4# #5#): #3#'
							520 => '<b>#7#</b> #2# (#8# - #4# #5#)'
							540 => '<b>#7#</b> #2# (#8# - #4# #5#)'
							550 => '<b>#7#</b> #2# (#8# - #4# #5#): #3#, #6#'
							560 => '<b>#7#</b> #2# (#8# - #4# #5#)'

						}

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.childReferral">
			
			SELECT 	tr.trans_id,
			to_char(tr.data_date_a,'MM/DD/YY'),
			(SELECT rsd.name
			FROM ref_service_category rsd , transaction tp
			WHERE rsd.serv_category = tsr.trans_expire_reason
			AND	tp.trans_id = tsr.parent_trans_id),
			(SELECT caption FROM referral_followup_status where id = tr.trans_status_reason),
			to_char(tr.data_date_b,'MM/DD/YY'),
			tr.trans_type,
			(SELECT parent_trans_id FROM transaction where trans_id = tr.parent_trans_id)
			FROM transaction tsr, transaction tr
			WHERE tsr.parent_trans_id = ?
			AND	tr.parent_trans_id = tsr.trans_id
			ORDER BY 1 desc
			
			<report>
				<column index="0" heading="RID" url="/org/#session.org_id#/dlg-update-trans-6010/#0#"/>
				<column index="1" heading="Date"/>
				<column index="2" heading="Type"/>
				<column index="3" heading="FUD"/>
				<column index="4" heading="Followup"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '0'
						dAlign => 'center'
						hHint => 'Referral ID'
						head => 'RID'
						tDataFmt => '&{count:0} Referrals'
						url => '/org/#session.org_id#/dlg-update-trans-6010/#0#'

					}
					1 => {
						colIdx => '1'
						hHint => 'Referral Date'
						head => 'Date'

					}
					2 => {
						colIdx => '2'
						dAlign => 'center'
						hHint => 'Referral Type'
						head => 'Type'

					}
					3 => {
						colIdx => '3'
						dAlign => 'center'
						hHint => 'Follow Up Date'
						head => 'FUD'

					}
					4 => {
						colIdx => '4'
						dAlign => 'center'
						hHint => 'Follow Up Caption'
						head => 'Followup'

					}

				}
				frame => {

				}

			-->
		</statement>

		<statement name="person.clinical">
			
			select 	value_type, item_id, item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 111111
			
			<params>
				<param value="request:parent_id"/>
			</params>
		</statement>

		<statement name="person.contactMethods">
			
			SELECT
			value_int,
			value_type,
			item_name,
			value_text,
			item_id,
			'attr-Person-' AS dialogid_suffix
			FROM Person_Attribute
			WHERE
			parent_id = ?
			AND	value_type IN (
			10,
			15,
			20,
			40,
			50,
			25
			)
			ORDER BY
			value_type,
			name_sort,
			item_name

			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="P"/>
				<column heading="Type"/>
				<column heading="Value"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-#5#/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						comments => 'Boolean value indicating whether the contact method is a preferred method or not'
						dataFmt => {
							0 => ''
							1 => '<IMG SRC="/resources/icons/checkmark.gif">'

						}
						hHint => 'Preferred Method'
						head => 'P'
						hint => 'Preferred'

					}
					1 => {
						dAlign => 'RIGHT'
						dataFmt => '#4#:'
						head => 'Type'

					}
					2 => {
						head => 'Value'

					}

				}

			-->
		</statement>

		<statement name="person.contactMethodsAndAddresses">
			
			SELECT
			value_int AS preferred,
			value_type,
			value_text || ' (' || item_name || ')',
			item_id,
			avt.caption AS caption,
			'attr-Person-' || value_type AS dialogid_suffix
			FROM
			Person_attribute,
			attribute_value_type avt
			WHERE
			parent_id = ?
			AND	value_type IN (
			10,
			15,
			20,
			40,
			50,
			25
			)
			AND	avt.id = value_type
			UNION ALL (
			SELECT
			0 as preferred,
			99998 AS value_type,
			'-' AS value_text,
			-1,
			'-',
			'-'
			FROM dual
			)
			UNION ALL (
			SELECT
			0 AS preferred,
			99910 AS value_type,
			complete_addr_html AS value_text,
			item_id,
			address_name AS caption,
			DECODE('Person', 'Person', 'attr-person-', 'Org', 'attr-org-' ) || 99910 AS dialogid_suffix
			FROM Person_address
			WHERE parent_id = ?
			)
			ORDER BY value_type

			<params>
				<param value="request:parent_id"/>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="P"/>
				<column heading="Type"/>
				<column heading="Value"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-#5#/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						comments => 'Boolean value indicating whether the contact method is a preferred method or not'
						dataFmt => {
							0 => ''
							1 => '<IMG SRC="/resources/icons/checkmark.gif">'

						}
						hHint => 'Preferred Method'
						head => 'P'
						hint => 'Preferred'

					}
					1 => {
						dAlign => 'RIGHT'
						dataFmt => '#4#:'
						head => 'Type'

					}
					2 => {
						head => 'Value'

					}

				}

			-->
		</statement>

		<statement name="person.diagnosisSummary">
			
			select member_name as code, name as description, to_char(min(trans_begin_stamp), 'mm/dd/yyyy') as earliest_date,
			to_char(max(trans_begin_stamp), 'mm/dd/yyyy') as latest_date, count(member_name) as num_times
			from ref_icd, invoice_claim_diags,transaction, invoice
			where client_id = ?
			and trans_id = main_transaction
			and invoice_claim_diags.parent_id = invoice.invoice_id
			and ref_icd.icd (+) = member_name
			group by member_name, name
			
			<params>
				<param value="request:client_id"/>
			</params>
			<report>
				<column heading="Diagnosis Summary"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<A HREF = "/search/icd/detail/#0#">(ICD #0#)</A> #1#<br> #2#--#3#: #4#<br><br>'
						head => 'Diagnosis Summary'

					}

				}

			-->
		</statement>

		<statement name="person.docPhone">
			
			select trans_id, trans_owner_id, trans_type, decode(trans_status,4,'Read',5,'Not Read'), caption, provider_id, decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')), data_text_a, data_text_b, consult_id,complete_name
			from Transaction,person
			where trans_owner_id = ?
			and caption = 'Phone Message'
			and data_num_a is not null
			and trans_status = 5
			and person.person_id = consult_id
			
			<params>
				<param value="request:trans_owner_id"/>
			</params>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<A HREF='/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#2#/#0#?home=#homeArl#' >#10#</A>: (#6#): #7# '

					}

				}

			-->
		</statement>

		<statement name="person.docRefill">
			
			select 	trans_id, trans_owner_id, trans_type, decode(trans_status,7,'Filled',6,'Pending'), caption,
			provider_id, decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')), data_text_a, data_text_b, processor_id, receiver_id,
			person.complete_name
			from Transaction,person
			where 	trans_owner_id = ?
			and caption = 'Refill Request'
			and data_num_a is null
			and processor_id = person_id
			union
			select 	trans_id, trans_owner_id, trans_type, decode(trans_status,7,'Filled',6,'Pending'), caption,
			provider_id, decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')), data_text_a, data_text_b, processor_id, receiver_id,
			person.complete_name
			from Transaction, person
			where trans_owner_id = ?
			and caption = 'Refill Request'
			and data_num_a is not null
			and processor_id = person_id
			and trans_status = 6
			
			<params>
				<param value="request:trans_owner_id"/>
				<param value="request:trans_owner_id"/>
			</params>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<A HREF = '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-refill-#2#/#0#?home=#homeArl#'> #11#</A> : (#6#) #7# (#3#)'

					}

				}

			-->
		</statement>

		<statement name="person.docResults">
			
			select 	'Ms Cindy Crawford',to_char(sysdate,'Mon-DD'), 'Lab','CBC' ,'CCRAWFORD','Abnormal' FROM DUAL
			UNION
			select 	'GEORGE SCHMIDT' ,to_char(sysdate,'Mon-DD'),'X-Ray','Chest-Xray', 'GSCHMIDT','Normal' FROM DUAL
			
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<A HREF='javascript:alert("NOT IMPLEMENTED")' >#0#</A>: (#1#) #3#  <B>#5#</B>'

					}

				}

			-->
		</statement>

		<statement name="person.docSign">
			
select 'NOT IMPLEMENTED' from dual
			
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<B>#0#</B>'

					}

				}

			-->
		</statement>

		<statement name="person.emergencyAssociations">
			
			select 	value_type, item_id, item_name,
			(select p.person_id
			from person p
			where p.person_id = b.value_text)person_id, value_textb,
			(select a.value_text
			from person_attribute a
			where a.value_int = 0
			and a.item_id = b.item_id)value_text
			from 	person_attribute b
			where	parent_id = ?
			and 	value_type = 201
			and 	item_name not in( 'Guarantor', 'Responsible Party')
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Emergency Contact"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF ="/person/#3#/profile">#3#</A>#5# (&{fmt_stripLeadingPath:2}, <NOBR>#4#</NOBR>)'
						head => 'Emergency Contact'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-assoc-contact-emergency?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.employmentAssociations">
			
			select	pa.value_type, pa.item_id, pa.item_name, pa.value_text, avt.caption
			from 	person_attribute pa, attribute_value_type avt
			where	pa.parent_id = ?
			and	pa.value_type = avt.id
			and pa.value_type between 220 and 227
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Employer"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF = "/org/#3#/profile">#3#</A><BR>#4#, &{fmt_stripLeadingPath:2}'
						head => 'Employer'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-assoc-employment?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.employmentRecord">
			
			select 	value_type, item_id, item_name, value_text
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 810
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Record"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2}: '
						head => 'Record'
						options => '1'

					}
					1 => {
						dataFmt => '#3#'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.extendedHealthCoverage">
			
			SELECT 	decode(bill_sequence, 1,'Primary',2,'Secondary',3,'Tertiary',4,'Quaternary',5,'W. Comp', 98, 'Terminated', 99, 'InActive'),
			decode(ins_type,0,'Self-Pay',1,'Insurance',2,'HMO',3,'PPO',4,'Medicare',5,'Medicaid',6,'W.Comp',7,'Client Billing',8,'Champus',9,'ChampVA',10,
			'FECA Blk Lung',11,'BCBS'),
			member_number,
			ins_internal_id,
			record_type,
			plan_name,
			policy_number,
			copay_amt,
			coverage_end_date,
			ins_org_id,
			product_name,
			(
			SELECT 	b.org_id
			FROM org b
			WHERE b.org_internal_id = i.ins_org_id
			) AS org_id,
			guarantor_id,
			guarantor_name,
			guarantor_type,
			(
			SELECT 	b.org_id
			FROM org b
			WHERE b.org_internal_id = i.ins_org_id
			) AS org_id,
			(
			SELECT 	g.org_id
			FROM org g
			WHERE guarantor_type = 1
			AND g.org_internal_id = i.guarantor_id
			),
			i.coverage_begin_date
			FROM 	insurance i
			WHERE 	owner_person_id = ?
			ORDER BY bill_sequence
			
			<params>
				<param value="request:owner_person_id"/>
			</params>
			<report>
				<column index="14"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-ins-#4#/#3#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '14'
						dataFmt => {
							 => '<b>#0#</b> (#1#, <b>#11#</b>, #10#)<BR><b> Policy Name: </b>#5# (#6#) <BR><b>  Member Num: </b>#2#, <b>Co-Pay:</b> $#7#, Begin Date: #17#, End Date: #8#'
							0 => '<b>Client Billing (</b><A HREF = "/person/#12#/profile">#13#</A>, Third Party)'
							1 => '<A HREF = "/org/#15#/profile">#13#</A> (Third Party)'

						}

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-ins-coverage?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.familyAssociations">
			
			select 	value_type, item_id, item_name,
			(select p.person_id
			from person p
			where p.person_id = b.value_text)person_id, value_textb,
			(select a.value_text
			from person_attribute a
			where a.value_int = 0
			and a.item_id = b.item_id)value_text
			from 	person_attribute b
			where	parent_id = ?
			and	value_type = 200
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Family Contact"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF ="/person/#3#/profile">#3#</A>#5# (&{fmt_stripLeadingPath:2}, <NOBR>#4#</NOBR>)'
						head => 'Family Contact'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-assoc-contact-family?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.feeschedules">
			
SELECT	oc.catalog_id,
			oc.caption,
			oc.description,
			oc.internal_catalog_id,
			pa.item_id
			FROM person_attribute pa,
			offering_catalog oc
			WHERE pa.parent_id = ?
			AND	pa.item_name = 'Fee Schedule'
			AND	pa.item_type = 0
			AND	pa.value_type = 110
			AND	pa.value_int = oc.internal_catalog_id
			ORDER BY oc.catalog_id
			
			<report>
				<column heading="Associated Fee Schedules"/>
				<column index="1"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-feeschedule-person/#4#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF=/org/#session.org_id#/catalog/#3#/#0#>#0#</A>'
						head => 'Associated Fee Schedules'

					}
					1 => {
						colIdx => '1'
						dAlign => 'left'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-feeschedule-person?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.group-account-notes">
			
			select complete_name, count (*) as count, min(trans_begin_stamp),max(trans_begin_stamp),
			trans_owner_id
			from transaction, person
			where provider_id = ? and
			trans_owner_id = person_id and
			trans_status = 2 and
			trans_type = 9500
			group by complete_name,trans_owner_id
			
			<params>
				<param value="request:provider_id"/>
			</params>
			<report>
				<column heading="Patient Name" url="/person/#4#/profile"/>
				<column heading="Notes#" url="/person/#param.person_id#/stpe-person.account-notes?home=#homeArl#&person_id=#4#"/>
				<column heading="First  Note Date"/>
				<column heading="Last Note Date"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						head => 'Patient Name'
						url => '/person/#4#/profile'

					}
					1 => {
						dAlign => 'right'
						head => 'Notes#'
						url => '/person/#param.person_id#/stpe-person.account-notes?home=#homeArl#&person_id=#4#'

					}
					2 => {
						head => 'First  Note Date'

					}
					3 => {
						head => 'Last Note Date'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.hospitalizationSurgeriesTherapies">
			
			select decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')), org.name_primary, org.org_id, provider_id, caption, data_num_a, detail, data_text_c,
			trans_type, trans_id, decode(to_char(trans_end_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_end_stamp, 'Mon DD'), to_char(trans_end_stamp, 'MM/DD/YY')), auth_ref, data_text_a, data_text_b
			from 	org, transaction
			where 	trans_type between 11000 and 11999
			and 	trans_owner_id = ?
			and 	trans_status = 2
			and service_facility_id = org.org_internal_id
			
			<params>
				<param value="request:trans_owner_id"/>
			</params>
			<report>
				<column index="3" heading="Provider"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#8#/#9#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '3'
						dataFmt => '#1# (<A HREF ="/org/#2#/profile">#2#</A>)<BR>Admitted by <A HREF ="/person/#3#/profile">#3#</A> (#0#), Discharged (#10#)<BR>Room: #4#, Prior Auth: #11#<BR>ICD(s): #6#, CPT(s): #7#'
						head => 'Provider'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-hospitalization?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.inPatient">
			
			select t.trans_owner_id , t.caption as room_number, initcap(p.short_sortable_name)
			as simple_name, t.consult_id, o.name_primary, decode(to_char(t.trans_begin_stamp - ?, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(t.trans_begin_stamp - ?, 'Mon DD'), to_char(t.trans_begin_stamp - ?, 'MM/DD/YY'))
			as admit_date, data_num_a
			FROM org o, person p, transaction t
			WHERE
			t.trans_type BETWEEN 11000 AND 11999
			AND	t.provider_id = ?
			AND p.person_id = t.trans_owner_id
			AND t.trans_status = 2
			AND t.trans_begin_stamp &gt;= to_date(?, 'MM/DD/YYYY') - data_num_a
			AND o.org_internal_id = t.service_facility_id
			ORDER by p.name_last
			
			<report>
				<column index="2" heading="Patient " url="/person/#0#/profile"/>
				<column heading="Hospital/Room"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '2'
						head => 'Patient '
						hint => '#3#'
						options => '1'
						url => '/person/#0#/profile'

					}
					1 => {
						dAlign => 'left'
						dataFmt => '#5# <br> <b>#4#</b> - Room #1# <br> Duration: #6# day(s)'
						hAlign => 'left'
						head => 'Hospital/Room'

					}

				}

			-->
		</statement>

		<statement name="person.inactiveMedications">
			
			SELECT
			permed_id,
			med_name,
			dose,
			dose_units,
			route,
			frequency,
			TO_CHAR(start_date, 'IYYYMMDD') as start_date,
			TO_CHAR(end_date, 'IYYYMMDD') as end_date,
			notes
			FROM
			Person_Medication
			WHERE
			parent_id = ? AND
			end_date &lt; TRUNC(sysdate)
			ORDER BY
			start_date DESC,
			med_name
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="1" heading="Medication"/>
				<column index="6" type="date" heading="Date"/>
				<column index="7" type="date" heading="End Date"/>
				<column heading="Dosage"/>
				<column index="5" heading="Freq"/>
				<column index="4" heading="Route"/>
				<column index="8" heading="Notes"/>
			</report>
			<!--
				bullets => {
					0 => {
						imgSrc => '/resources/widgets/mail/prescription.gif'
						title => 'Refill Request'
						urlFmt => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-refill-medication/#0#?home=#homeArl#'

					}

				}
				columnDefn => {
					0 => {
						colIdx => '1'
						head => 'Medication'

					}
					1 => {
						colIdx => '6'
						dformat => 'date'
						head => 'Date'

					}
					2 => {
						colIdx => '7'
						dformat => 'date'
						head => 'End Date'

					}
					3 => {
						dataFmt => '#2##3#'
						head => 'Dosage'

					}
					4 => {
						colIdx => '5'
						head => 'Freq'

					}
					5 => {
						colIdx => '4'
						head => 'Route'

					}
					6 => {
						colIdx => '8'
						head => 'Notes'

					}

				}

			-->
		</statement>

		<statement name="person.insurance">
			
			SELECT
			ins_internal_id,
			parent_ins_id,
			product_name,
			DECODE(record_type, 3, 'coverage') AS record_type,
			plan_name,
			DECODE(bill_sequence,1,'Primary',2,'Secondary',3,'Tertiary',4,'Quaternary',5,'W. Comp', 98, 'Terminated', 99, 'InActive', 'Active'),
			owner_person_id,
			ins_org_id,
			indiv_deductible_amt,
			family_deductible_amt,
			percentage_pay,
			copay_amt,
			guarantor_name,
			decode(ins_type, 7, 'thirdparty', 'coverage') AS ins_type,
			guarantor_id,
			guarantor_type,
			(
			SELECT 	b.org_id
			FROM org b
			WHERE b.org_internal_id = i.ins_org_id
			) AS org_id,
			(
			SELECT 	g.org_id
			FROM org g
			WHERE guarantor_type = 1
			AND g.org_internal_id = i.guarantor_id
			),
			i.coverage_begin_date,
			i.coverage_end_date
			FROM insurance i
			WHERE record_type = 3
			AND owner_person_id = ?
			ORDER BY bill_sequence
			
			<params>
				<param value="request:owner_person_id"/>
			</params>
			<report>
				<column index="15"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-ins-#13#/#0#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '15'
						dataFmt => {
							 => '<A HREF = "/org/#16#/profile">#16#</A>(#5# #13#): #4#, #2#, Begin Date: #18#, End Date: #19#'
							0 => '<A HREF = "/person/#14#/profile">#12#</A> (Third Party, #5#): Begin Date: #18#, End Date: #19#'
							1 => '<A HREF = "/org/#17#/profile">#12#</A> (Third Party, #5#): Begin Date: #18#, End Date: #19#'

						}

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.insuranceVerify">
			
			SELECT * FROM (
			select s.event_id, s.person_id, s.ins_verified_by, 
			to_char(s.ins_verify_date, 'MM/DD/YYYY') as verify_date,
			to_char(e.start_time, 'MM/DD/YYYY HH12:MI AM') as appt_time,
			o.org_id, ea.value_textb as provider_id
			from event_attribute ea, org o, event e, sch_verify s
			where person_id = ?
			and e.event_id = s.event_id
			and o.org_internal_id = e.facility_id
			and ea.parent_id = e.event_id
			order by ins_verify_date DESC
			)
			WHERE ROWNUM &lt; 11
			
			<report>
				<column index="4" heading="Appointment Time"/>
				<column index="2" heading="Verified By"/>
				<column index="3" heading="Verify Date"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/dlg-view-insurance-records/#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '4'
						head => 'Appointment Time'

					}
					1 => {
						colIdx => '2'
						head => 'Verified By'

					}
					2 => {
						colIdx => '3'
						head => 'Verify Date'

					}

				}

			-->
		</statement>

		<statement name="person.labOrderDetail">
			
			Select	lo.lab_order_id,lo.date_order,lo.provider_id, los.caption
			FROM	org ,person_lab_order lo, lab_order_status los
			WHERE 	owner_org_id= ?
			AND	lo.lab_internal_id = org.org_internal_id
			AND 	lo.lab_internal_id = ?
			AND	lo.person_id = ?
			AND	los.id = lo.lab_order_status
			order by date_order desc
			
			<report>
				<column index="0" heading="Lab Order ID"/>
				<column index="1" type="date" heading="Order Date"/>
				<column index="2" heading="Provider ID"/>
				<column index="3" heading="Lab Order Status"/>
			</report>
			<!--
				bullets => {
					0 => '/person/#param.person_id#/dlg-update-lab-order/#0#?home=#homeArl#'

				}
				columnDefn => {
					0 => {
						colIdx => '0'
						hAlign => 'left'
						head => 'Lab Order ID'

					}
					1 => {
						colIdx => '1'
						dformat => 'date'
						hAlign => 'left'
						head => 'Order Date'

					}
					2 => {
						colIdx => '2'
						hAlign => 'left'
						head => 'Provider ID'

					}
					3 => {
						colIdx => '3'
						hAlign => 'left'
						head => 'Lab Order Status'

					}

				}

			-->
		</statement>

		<statement name="person.labOrderSummary">
			
			Select	org_id,name_primary,org_internal_id,
			(SELECT count (*)
			FROM 	person_lab_order lo
			WHERE 	lo.person_id = ?
			AND	lo.lab_internal_id = org.org_internal_id
			) as entry
			FROM	org ,ORG_CATEGORY oc
			WHERE 	owner_org_id= ?
			AND	oc.parent_id = org.org_internal_id
			AND	oc.member_name='Ancillary Service'
			order by org_id
			
			<report>
				<column index="1" heading="Lab Name" url="/person/#param.person_id#/dlg-add-lab-order/#0#?home=#homeArl#&org_id=#0#"/>
				<column index="3" heading="Patient Lab Requests"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '1'
						hAlign => 'left'
						head => 'Lab Name'
						hint => 'Add Order Entry to #1#'
						url => '/person/#param.person_id#/dlg-add-lab-order/#0#?home=#homeArl#&org_id=#0#'

					}
					1 => {
						colIdx => '3'
						hAlign => 'left'
						head => 'Patient Lab Requests'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.linkMedicalSite">
			
			select 'PDR NET','Meidical Reference Information','http://physician.pdr.net/physician/index.htm',to_number(NULL) as item_id FROM dual
			UNION
			SELECT 	value_text,value_textb,name_sort,item_id FROM person_attribute
			WHERE 	parent_id = ?
			AND	item_name = 'User/Link/Medical'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/dlg-update-link-med-url/#3#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF="#2#" TARGET="NEWS">#0#</A>'

					}
					1 => {
						dataFmt => '#1#'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/dlg-add-link-med-url'

				}

			-->
		</statement>

		<statement name="person.linkNonMedicalSite">
			
			SELECT 'CNN','News And Information','http://www.cnn.com',to_number(NULL) as item_id FROM dual
			UNION
			SELECT 	value_text,value_textb,name_sort,item_id FROM person_attribute
			WHERE 	parent_id = ?
			AND	item_name = 'User/Link/NonMedical'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/dlg-update-link-non-url/#3#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF="#2#" TARGET="NEWS">#0#</A>'

					}
					1 => {
						dataFmt => '#1#'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/dlg-add-link-non-url'

				}

			-->
		</statement>

		<statement name="person.messageCounts">
			
SELECT doc_spec_subtype, count(*)
			FROM document, document_attribute
			WHERE document_attribute.value_text = ?
			AND document.doc_spec_type = 2000
			AND document.doc_id = document_attribute.parent_id
			AND document_attribute.item_name IN ('To', 'CC')
			AND document_attribute.value_int = 0
			AND document.cr_org_internal_id = ?
			GROUP BY document.doc_spec_subtype
			union
			SELECT '-1' as doc_spec_subtype,count (*)
			FROM	observation
			WHERE	observation.observer_org_id = ?
			AND	observation.observer_id = ?
			group by 1
			
			<report>
				<column index="0"/>
				<column index="1"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '0'
						dataFmt => {
							-1 => '<a href='/worklist/documents/labs'>Results</a>'
							0 => '<a href='/person/#param.person_id#/mailbox/internalMessages'>Internal Message</a>'
							1 => '<a href='/person/#param.person_id#/mailbox/phoneMessages'>Phone Message</a>'
							2 => '<a href='/person/#param.person_id#/mailbox/prescriptionRequests'>Prescription Approval Request</a>'

						}

					}
					1 => {
						colIdx => '1'

					}

				}

			-->
		</statement>

		<statement name="person.messageRegardingPatient">
			
			SELECT * FROM (
			select d.doc_name, to_char(d.doc_orig_stamp - ?, 'MM/DD/YYYY HH12:MI AM')
			as doc_orig_stamp, d.doc_source_id, d.doc_dest_ids, d.doc_spec_subtype,
			d.doc_id
			from document d, document_attribute da
			where da.item_name = 'Regarding Patient'
			and da.value_text = ?
			and d.doc_id = da.parent_id
			order by d.doc_orig_stamp DESC
			)
			WHERE ROWNUM &lt; 11
			
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<a href="/person/#session.user_id#/dlg-read-message_#4#/#5#/#4#?home=#homeArl#" >#1#</a> &nbsp; From: #2# - To: #3# <br>&nbsp; #0#'

					}

				}

			-->
		</statement>

		<statement name="person.miscNotes">
			
			SELECT
			value_type,
			item_id,
			parent_id,
			item_name,
			value_text,
			decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY')),
			value_textB
			from Person_Attribute
			where 	parent_id = ?
			and item_name = 'Misc Notes'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-misc-notes/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => 'Misc Notes by <A HREF="/person/#6#/profile">#6#</A> (#5#): #4#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-misc-notes?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.myAssociatedResourceAppointments">
			
			select to_char(e.start_time - ?, 'hh:miam') as start_time,
			ea.value_textB as resource_id,
			patient.simple_name as patient_complete_name,
			e.subject,
			at.caption as appt_type,
			aat.caption as patient_type,
			e.remarks,
			ea.value_text as patient_id,
			e.event_id, patient.person_id
			from 	Appt_Status, Appt_Attendee_type aat, Person patient, Person provider,
			Event_Attribute ea, Appt_Type at, Event e
			where e.start_time between to_date(?, 'MM/DD/YYYY HH12:MI AM') + ?
			and to_date(?, 'MM/DD/YYYY HH12:MI AM') + ?
			and e.discard_type is null
			and e.event_status in (0,1,2)
			and at.appt_type_id (+) = e.appt_type
			and ea.parent_id = e.event_id
			and ea.value_type = 333
			and ea.value_text = patient.person_id
			and ea.value_textB = provider.person_id
			and
			(	ea.value_textB = ? or
			ea.value_textB in
			(select value_text
			from person_attribute
			where parent_id = ?
			and item_name = 'WorkList'
			and value_type = 250
			and parent_org_id = ?
			)
			)
			and aat.id = ea.value_int
			and Appt_Status.id = e.event_status
			order by e.start_time
			
			<report>
				<column heading="My Associated Resources Appointments"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-appointment/#8#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<a href="javascript:location='/schedule/apptsheet/encounterCheckin/#8#';">#0#</A>:'
						head => 'My Associated Resources Appointments'

					}
					1 => {
						dataFmt => '<A HREF="/person/#7#/profile">#2#</A> <BR> (<i>#5#</i>) <BR> Scheduled with #1# <BR> Appt Type: #4#  <BR> Subject: #3#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-appointment?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.myAssociatedResourceInPatients">
			
			SELECT
			decode(to_char(trans_begin_stamp - ?, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp - ?, 'Mon DD'), to_char(trans_begin_stamp - ?, 'MM/DD/YY')),
			initcap(simple_name) as simple_name,
			provider_id,
			caption as room_number,
			data_num_a as duration_days,
			detail as diags,
			data_text_c as procedures,
			data_text_a,
			consult_id,
			trans_id,
			trans_type,
			trans_owner_id,
			org.name_primary
			FROM
			org,
			transaction,
			person
			WHERE
			trans_type BETWEEN 11000 AND 11999 AND
			person_id = trans_owner_id AND
			(
			provider_id = ? OR provider_id IN
			(
			SELECT value_text
			FROM person_attribute
			WHERE parent_id = ?
			AND value_type = 250
			AND item_name = 'WorkList'
			AND parent_org_id = ?
			)
			) AND
			trans_status = 2
			AND (SYSDATE - trans_begin_stamp) &lt;= data_num_a
			AND org.org_internal_id = transaction.service_facility_id
			ORDER BY trans_begin_stamp DESC
			
			<report>
				<column heading="My Associated Resources In Patients"/>
			</report>
			<!--
				bullets => '/person/#11#/stpe-#my.stmtId#/dlg-update-trans-#10#/#9#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#0#'
						head => 'My Associated Resources In Patients'

					}
					1 => {
						dataFmt => '<A HREF="/person/#11#/chart">#1#</A> <BR>
					<b>#12#</b> <BR>
					(#2#) <br>
					Room: #3#  <BR>
					Duration of Stay: #4# day(s)<BR>
					Diagnoses: #5# <BR>
					Procedures: #6#
				'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-hospitalization?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.mySessionActivity">
			
			select to_char(pa.activity_stamp - ? - ?, 'MM/DD/YYYY HH12:MI AM') as activity_stamp,
			sat.caption as caption,
			pa.activity_data as data,
			pa.action_scope as scope,
			pa.action_key as action_key
			from Session_Action_Type sat, perSess_Activity pa
			where pa.person_id = ?
			and	pa.activity_stamp &gt;= trunc(sysdate) + ? + ?
			and	sat.id = pa.action_type
			and 10 &gt; (
			select count(*) from perSess_Activity pa2
			where pa.activity_stamp &lt; pa2.activity_stamp
			and pa.person_id = pa2.person_id
			)
			order by pa.activity_stamp desc
			
			<report>
				<column heading="My Session Activity"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '#0# '
						head => 'My Session Activity'

					}
					1 => {
						dataFmt => '#1# #2#'

					}

				}

			-->
		</statement>

		<statement name="person.officeLocation">
			
			SELECT 	value_type, item_id, parent_id, item_name, value_text, value_textB, value_int, name_primary
			from Person_Attribute, Org
			where 	parent_id = ?
			AND value_text = org_id
			AND item_name = 'Office Location'
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column index="6"/>
				<column index="2"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-office-location/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '6'
						dataFmt => {
							 => ''
							1 => '<img src="/resources/icons/checkmark.gif" width="16" height="16" border="0">'

						}

					}
					1 => {
						colIdx => '2'
						dataFmt => '<A HREF = '/org/#4#/profile'>#7#</A> (#4#, #5#) '

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-office-location?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.patientAppointments">
			
			select 	decode(to_char(e.start_time - ?, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(e.start_time - ?, 'Mon DD'), to_char(e.start_time - ?, 'MM/DD/YY')),
			to_char(e.start_time - ?, 'HH12:MI AM'),
			ea.value_textB,
			e.subject,
			to_char(e.start_time - ?, 'MM-DD-YYYY'),
			1 as group_sort,
			e.start_time as apptdate
			from Event_Attribute ea, Event e
			where ea.parent_id = e.event_id
			and ea.value_type = 333
			and ea.value_text = ?
			and e.event_status != 3
			and e.start_time &gt; sysdate
			UNION
			select 	decode(to_char(sysdate - ?, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(sysdate - ?, 'Mon DD'), to_char(sysdate - ?, 'MM/DD/YY')),
			to_char(sysdate - ?, 'HH12:MI AM'),
			'-',
			'-',
			to_char(sysdate - ?, 'MM-DD-YYYY'),
			2 as group_sort,
			trunc(sysdate) as apptdate
			from DUAL
			UNION
			select 	decode(to_char(e.start_time - ?, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(e.start_time - ?, 'Mon DD'), to_char(e.start_time - ?, 'MM/DD/YY')),
			to_char(e.start_time - ?, 'HH12:MI AM'),
			ea.value_textB,
			e.subject,
			to_char(e.start_time - ?, 'MM-DD-YYYY'),
			3 as group_sort,
			e.start_time as apptdate
			from Event_Attribute ea, Event e
			where ea.parent_id = e.event_id
			and ea.value_type = 333
			and ea.value_text = ?
			and e.event_status != 3
			and e.start_time &lt; sysdate
			and 10 &gt; (select count(*) from Event_Attribute ea2, Event e2
			where ea2.parent_id = e2.event_id
			and ea2.value_text = ea.value_text
			and ea2.value_type = 333
			and e.start_time &lt; e2.start_time
			and e2.event_status != 3
			and e2.start_time &lt; sysdate
			)
			ORDER by group_sort, apptdate DESC
			
			<report>
				<column heading="Appointments"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<a href="javascript:location='/schedule/apptsheet/#4#';">#0#</A>:'
						head => 'Appointments'

					}
					1 => {
						dataFmt => 'Scheduled with <A HREF="/person/#2#/profile">#2#</A> at #1# <BR>
					Reason for Visit: #3#'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-appointment?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}
				separateDataColIdx => '2'

			-->
		</statement>

		<statement name="person.patientInfo">
			
			SELECT
			UNIQUE person_id,
			ssn,
			date_of_birth,
			simple_name,
			g.caption
			FROM	person p, transaction t, gender g
			WHERE trans_type in (6000, 6010)
			AND consult_id = ?
			AND 	 p.person_id = t.consult_id
			AND 	 g.id = p.gender
			
			<params>
				<param value="request:consult_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-patient?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<a href='/person/#0#/profile'>#3#</a>: SSN (#1#), DOB(#2#), Gender(#4#)'

					}

				}

			-->
		</statement>

		<statement name="person.personCategory">
			
			select 	p.simple_name, pa.category, pa.person_id, pa.org_internal_id
			from 	person_org_category pa, person p
			where	 p.person_id = ?
			and pa.org_internal_id = ?
			and pa.category in ('Patient', 'Guarantor','Insured-Person')
			and	p.person_id = pa.person_id
			order by pa.category
			
			<params>
				<param value="request:person_id"/>
				<param value="request:org_internal_id"/>
			</params>
			<report>
				<column heading="Type"/>
			</report>
			<!--
				bullets => 'stpe-#my.stmtId#/dlg-update-person-category/?_f_person_id=#2#&_f_category=#1#&home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#1#'
						head => 'Type'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-person-category?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.phoneMessage">
			
			select trans_id, trans_owner_id, trans_type, decode(trans_status,4,'Read',5,'Not Read'),
			caption, provider_id, data_text_c, data_text_a, data_text_b, cr_user_id, consult_id
			from Transaction
			where trans_owner_id = ?
			and caption = 'Phone Message'
			and data_num_a is null
			UNION
			select trans_id, trans_owner_id, trans_type, decode(trans_status,4,'Read',5,'Not Read'),
			caption, provider_id, data_text_c, data_text_a, data_text_b, cr_user_id, consult_id
			from Transaction
			where trans_owner_id = ?
			and caption = 'Phone Message'
			and data_num_a is not null
			and trans_status = 5
			and trans_owner_id &lt;&gt; consult_id
			
			<params>
				<param value="request:trans_owner_id"/>
				<param value="request:trans_owner_id"/>
			</params>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#2#/#0#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '<A HREF='/person/#10#/profile'>#10#</A> (#6#): #7# (<A HREF='/person/#5#/profile'>#5#</A>)'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-send-phone_message?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.preventiveCare">
			
			select 	value_type, item_id, item_name, decode(to_char(value_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_date, 'Mon DD'), to_char(value_date, 'MM/DD/YY')), decode(to_char(value_dateend, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(value_dateend, 'Mon DD'), to_char(value_dateend, 'MM/DD/YY')), value_text, value_textb
			from 	person_attribute
			where 	parent_id = ?
			and 	value_type = 400
			
			<params>
				<param value="request:parent_id"/>
			</params>
			<report>
				<column heading="Preventive Care"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-remove-attr-#0#/#1#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '&{fmt_stripLeadingPath:2} : #6# (CPT #5#, #4#)'
						head => 'Preventive Care'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-preventivecare?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.recentlyVisitedPatients">
			
			select p.simple_name, pvc.view_key from PerSess_View_Count pvc,
			person p , Person_Org_Category pog
			where p.person_id = pvc.view_key AND pvc.person_id = ? and
			pog.person_id = p.person_id AND pog.category = 'Patient'
			and	pvc.view_latest &gt;= trunc(sysdate) + ?
			order by pvc.view_latest desc
			
			<report>
				<column heading="Recently Visited Patients"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<A HREF="/person/#1#/profile" >#1#</A> <A> (#0#)</A>'
						head => 'Recently Visited Patients'

					}

				}

			-->
		</statement>

		<statement name="person.referralAndIntake">
			
			SELECT 	trans_id,
			to_char(data_date_a,'MM/DD/YY'),
			(SELECT to_char(data_date_a,'MM/DD/YY') FROM transaction where trans_id = t.parent_trans_id),
			(
			SELECT rsd.name
			FROM ref_service_category rsd, transaction t1 where t1.trans_id = t.parent_trans_id
			AND t1.trans_expire_reason = rsd.SERV_CATEGORY
			),
			to_char(data_date_b,'MM/DD/YY'),
			(SELECT caption FROM referral_followup_status where id = trans_status_reason),
			trans_type,
			(SELECT parent_trans_id FROM transaction where trans_id = t.parent_trans_id),
			(SELECT to_char(t2.trans_end_stamp,'MM/DD/YY') FROM transaction t1, transaction t2 WHERE t1.trans_id = t.parent_trans_id
			AND	t2.trans_id = t1.parent_trans_id),
			(SELECT to_char(data_date_b,'MM/DD/YY') FROM transaction where trans_id = t.parent_trans_id)
			FROM transaction t
			WHERE 	consult_id = ?
			AND trans_type in (6010)
			ORDER BY 3 desc
			
			<params>
				<param value="request:consult_id"/>
			</params>
			<report>
				<column index="0" heading="RID"/>
				<column index="3" heading="Type"/>
				<column index="4" heading="FUD"/>
				<column index="5" heading="Followup"/>
				<column index="7" heading="SID" url="/org/#session.org_id#/dlg-update-trans-6000/#7#"/>
				<column index="8" heading="SD"/>
				<column index="2" heading="SBD"/>
				<column index="9" heading="SED"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/dlg-update-trans-#6#/#0#?home=#homeArl#'
				columnDefn => {
					0 => {
						colIdx => '0'
						dAlign => 'center'
						hHint => 'Referral ID'
						head => 'RID'
						hint => 'Referral ID'
						tDataFmt => '&{count:0} Referrals'

					}
					1 => {
						colIdx => '3'
						dAlign => 'center'
						hHint => 'Referral Type'
						head => 'Type'
						hint => 'Referral Type'

					}
					2 => {
						colIdx => '4'
						dAlign => 'center'
						hHint => 'Follow Up Date'
						head => 'FUD'
						hint => 'Follow Up Date'

					}
					3 => {
						colIdx => '5'
						dAlign => 'center'
						hHint => 'Follow Up Caption'
						head => 'Followup'
						hint => 'Follow Up Caption'

					}
					4 => {
						colIdx => '7'
						dAlign => 'center'
						hHint => 'Service Request ID'
						head => 'SID'
						hint => 'Service Request ID'
						url => '/org/#session.org_id#/dlg-update-trans-6000/#7#'

					}
					5 => {
						colIdx => '8'
						dAlign => 'center'
						hHint => 'Service Request Date'
						head => 'SD'
						hint => 'Service Request Date'

					}
					6 => {
						colIdx => '2'
						dAlign => 'center'
						hHint => 'Service Begin Date'
						head => 'SBD'
						hint => 'Service Begin Date'

					}
					7 => {
						colIdx => '9'
						dAlign => 'center'
						hHint => 'Service End Date'
						head => 'SED'
						hint => 'Service End Date'

					}

				}
				frame => {
					editUrl => '/person/#param.person_id#/dlg-add-referral?_f_person_id=#param.person_id#&home=#homeArl#'

				}

			-->
		</statement>

		<statement name="person.referralAndIntakeCount">
			
			SELECT
			(COUNT(trans_id)-COUNT(parent_trans_id)) AS service_request,
			COUNT(parent_trans_id) AS referral
			FROM transaction
			WHERE 	consult_id = ?
			AND trans_type in (6000, 6010)
			
			<params>
				<param value="request:consult_id"/>
			</params>
			<report>
				<column heading="Record Count"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						dataFmt => 'Service Request Count : #0# <BR> Referral Count : #1#'
						head => 'Record Count'

					}

				}

			-->
		</statement>

		<statement name="person.refillRequest">
			
			SELECT count(*)
			FROM document, document_attribute
			WHERE document_attribute.value_text = ?
			AND document.doc_spec_type = 2000
			AND document.doc_id = document_attribute.parent_id
			AND document_attribute.item_name IN ('To', 'CC')
			AND document_attribute.value_int = 0
			AND doc_spec_subtype = 2
			
			<!--
				columnDefn => {
					0 => {
						dataFmt => '<a href='/person/#param.person_id#/mailbox/prescriptionRequests'>Prescription Approval Request</a> #0#'

					}

				}

			-->
		</statement>

		<statement name="person.scheduleAppts">
			
			SELECT p.person_id, to_char(e.start_time - ?, 'hh:miam') as start_time,
			a.caption, e.subject as visit, org_id, initcap(p.short_sortable_name) as simple_name
			FROM appt_status a, org, person p, event_attribute ePhy, event e
			WHERE e.start_time &gt;= to_date(?, 'MM/DD/YYYY') + ?
			AND e.start_time &lt; to_date(?, 'MM/DD/YYYY') + ? + 1
			AND e.event_status &lt; 3
			AND ePhy.parent_id = e.event_id
			AND ePhy.item_name = 'Appointment'
			AND ePhy.value_textB = ?
			AND p.person_id = ePhy.VALUE_TEXT
			AND org.org_internal_id = e.facility_id
			AND a.id = e.event_status
			ORDER by e.start_time
			
			<report>
				<column index="5" heading="Patient" url="/person/#0#/profile"/>
				<column heading="Appointment Time"/>
				<column heading="Status"/>
				<column heading="Reason For Visit"/>
				<column heading="Facility"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '5'
						hAlign => 'left'
						head => 'Patient'
						options => '1'
						url => '/person/#0#/profile'

					}
					1 => {
						hAlign => 'left'
						head => 'Appointment Time'

					}
					2 => {
						hAlign => 'left'
						head => 'Status'

					}
					3 => {
						hAlign => 'left'
						head => 'Reason For Visit'

					}
					4 => {
						head => 'Facility'

					}

				}

			-->
		</statement>

		<statement name="person.sessionActivity">
			
			select 	decode(to_char(to_char(a.activity_stamp, 'MM/DD/YYYY HH12:MI AM'), 'YYYY'), to_char(sysdate, 'YYYY'), to_char(to_char(a.activity_stamp, 'MM/DD/YYYY HH12:MI AM'), 'Mon DD'), to_char(to_char(a.activity_stamp, 'MM/DD/YYYY HH12:MI AM'), 'MM/DD/YY')) as activity_date,
			b.caption as caption, a.activity_data as data,
			a.action_scope as scope, a.action_key as action_key
			from perSess_Activity a, Session_Action_Type b
			where 	activity_stamp &gt; (select max(activity_stamp) - 1 from perSess_Activity)
			and	a.session_id = ?
			and	a.action_type = b.id
			and 	rownum &lt;= 20
			order by activity_date desc
			
			<params>
				<param value="request:session_id"/>
			</params>
			<report>
				<column heading="Time"/>
				<column heading="Event"/>
				<column heading="Details"/>
				<column index="3" heading="Scope"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						head => 'Time'

					}
					1 => {
						head => 'Event'

					}
					2 => {
						head => 'Details'

					}
					3 => {
						colIdx => '3'
						dataFmt => {
							_DEFAULT => '#4#'
							insurance => 'Person <A HREF='/person/#4#/profile ' STYLE="text-decoration:none">#4#</A>'
							invoice => 'Claim <A HREF='/invoice/#4#/summary' STYLE="text-decoration:none">#4#</A>'
							invoice_item => 'Claim <A HREF='/invoice/#4#' STYLE="text-decoration:none">#4#</A>'
							offering_catalog => 'FeeSchedule <A HREF='/search/catalog/detail/#4#/' STYLE="text-decoration:none">#4#</A>'
							offering_catalog_entry => 'FeeSchedule <A HREF='/search/catalog/detail/#4#/ ' STYLE="text-decoration:none">#4#</A>'
							org => 'Organization <A HREF='/org/#4#/profile' STYLE="text-decoration:none">#4#</A>'
							org_attribute => 'Organization <A HREF='/org/#4#/profile' STYLE="text-decoration:none">#4#</A>'
							person => 'Person <A HREF='/person/#4#/profile ' STYLE="text-decoration:none">#4#</A>'
							person_address => 'Person <A HREF='/person/#4#/profile' STYLE="text-decoration:none">#4#</A>'
							person_attribute => 'Person <A HREF='/person/#4#/profile ' STYLE="text-decoration:none">#4#</A>'
							transaction => 'Person <A HREF='/person/#4#/profile' STYLE="text-decoration:none">#4#</A>'

						}
						head => 'Scope'

					}

				}

			-->
		</statement>

		<statement name="person.surgicalProcedures">
			
			SELECT
			data_text_a,
			decode(to_char(t.curr_onset_date, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(t.curr_onset_date, 'Mon DD'), to_char(t.curr_onset_date, 'MM/DD/YY')) AS curr_onset_date,
			ref.name,
			provider_id,
			trans_type,
			trans_id,
			'(CPT ' || t.code || ')' AS code
			FROM
			transaction t,
			ref_cpt ref
			WHERE
			trans_type = 4050
			AND trans_owner_id = ?
			AND t.code = ref.cpt (+)
			AND trans_status = 2
			ORDER BY
			curr_onset_date DESC
			
			<report>
				<column heading="Surgical Procedures"/>
			</report>
			<!--
				bullets => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-update-trans-#4#/#5#?home=#homeArl#'
				columnDefn => {
					0 => {
						dataFmt => '#0#: #2# <A HREF = "/search/icd">#6#</A><BR>performed by <A HREF = "/person/#3#/profile">#3#</A> (#1#)'
						head => 'Surgical Procedures'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-activeproblems-surgical?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}
				separateDataColIdx => '2'

			-->
		</statement>

		<statement name="person.testsAndMeasurements">
			
			select tm.trans_owner_id, to_char(tm.trans_begin_stamp - ?, 'mm/dd/yyyy HH:MI PM'),tm.data_text_b,tm.data_text_a,tc.no_of_tests
			from testsandmeasurements tm, testsandmeasurementscount tc
			where tm.trans_owner_id = tc.trans_owner_id
			and tm.data_text_b = tc.data_text_b
			and tm.trans_owner_id = ?
			
			<params>
				<param value="request:trans_owner_id"/>
			</params>
			<report>
				<column index="1" heading="Date"/>
				<column index="3" heading="Tests"/>
				<column index="4" heading="Value"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '1'
						dataFmt => '#1# #2#'
						head => 'Date'
						options => '1'

					}
					1 => {
						colIdx => '3'
						dAlign => 'LEFT'
						dataFmt => '#3#'
						head => 'Tests'
						options => '1'

					}
					2 => {
						colIdx => '4'
						dataFmt => '#4#'
						head => 'Value'

					}

				}
				frame => {
					addUrl => '/person/#param.person_id#/stpe-#my.stmtId#/dlg-add-tests?home=#homeArl#'
					editUrl => '/person/#param.person_id#/stpe-#my.stmtId#?home=#homeArl#'

				}

			-->
		</statement>

		<statement name="sel_referral">
			
			SELECT
			trans_id,
			trans_owner_id,
			a.ssn,
			a.date_of_birth,
			t.data_text_a as referral_type,
			aa.value_int as claim_number,
			trans_substatus_reason,
			trans_status_reason,
			t.data_text_b,
			t.data_text_c,
			t.caption,
			decode(to_char(trans_begin_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_begin_stamp, 'Mon DD'), to_char(trans_begin_stamp, 'MM/DD/YY')),
			decode(to_char(trans_end_stamp, 'YYYY'), to_char(sysdate, 'YYYY'), to_char(trans_end_stamp, 'Mon DD'), to_char(trans_end_stamp, 'MM/DD/YY')),
			t.data_text_a,
			t.data_num_a,
			detail,
			related_data,
			initiator_id
			from transaction t, person a, trans_attribute aa
			where trans_type = 6000
			and trans_id = ?
			and a.person_id = t.consult_id
			and aa.parent_id = t.trans_id
			and aa.item_name = 'Referral Insurance'
			
			<params>
				<param value="request:trans_id"/>
			</params>
			<report>
				<column index="0" heading="Trans ID"/>
				<column index="1" heading="Claim Number"/>
				<column index="2" heading="ICD Codes"/>
				<column index="3" heading="CPT Codes"/>
				<column index="4" heading="Date Of Injury"/>
				<column index="5" heading="Date Of Request"/>
				<column index="6" heading="Referral Type"/>
				<column index="7" heading="SSN"/>
				<column index="8" heading="Date of Birth"/>
				<column index="9" heading="Comments"/>
			</report>
			<!--
				columnDefn => {
					0 => {
						colIdx => '0'
						dataFmt => '<a href="javascript:doActionPopup('/org/#17#/dlg-update-trans-6000/#0#');">#0#</a>'
						head => 'Trans ID'

					}
					1 => {
						colIdx => '1'
						dataFmt => '#5#'
						head => 'Claim Number'

					}
					2 => {
						colIdx => '2'
						dataFmt => '<a href="javascript:doActionPopup('/lookup/icd');">#8#</a>'
						head => 'ICD Codes'

					}
					3 => {
						colIdx => '3'
						dataFmt => '<a href="javascript:doActionPopup('/lookup/cpt');">#9#</a>'
						head => 'CPT Codes'

					}
					4 => {
						colIdx => '4'
						dataFmt => '#11#'
						head => 'Date Of Injury'
						options => '1'

					}
					5 => {
						colIdx => '5'
						dataFmt => '#12#'
						head => 'Date Of Request'
						options => '1'

					}
					6 => {
						colIdx => '6'
						dataFmt => '#13#'
						head => 'Referral Type'

					}
					7 => {
						colIdx => '7'
						dataFmt => '#2#'
						head => 'SSN'

					}
					8 => {
						colIdx => '8'
						dataFmt => '#3#'
						head => 'Date of Birth'

					}
					9 => {
						colIdx => '9'
						dataFmt => '#16#'
						head => 'Comments'

					}

				}

			-->
		</statement>

	</sql-statements>
</xaf>